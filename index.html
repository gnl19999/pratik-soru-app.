<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kelime Uygulamasƒ± - Tam Otomatik</title>
    <style>
        /* --- GENEL AYARLAR --- */
        body { margin: 0; padding: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #4a6a7a; color: white; display: flex; justify-content: center; user-select: none; }
        .app-container { width: 100%; max-width: 500px; min-height: 100vh; position: relative; background-color: #4a6a7a; display: flex; flex-direction: column; overflow: hidden; }
        
        /* HEADER */
        header.home-header { display: flex; justify-content: space-between; align-items: center; padding: 15px 20px; background-color: #354f5c; position: sticky; top: 0; z-index: 10; box-shadow: 0 2px 10px rgba(0,0,0,0.2); }
        .settings-icon { font-size: 24px; cursor: pointer; color: #f1c40f; }
        .app-title { font-size: 20px; font-weight: bold; }
        .profile-pic { width: 40px; height: 40px; background-color: #f3d290; border-radius: 50%; display: flex; justify-content: center; align-items: center; font-size: 20px; }
        
        /* TABS */
        .tabs { display: flex; justify-content: space-around; padding: 15px 0; background-color: #354f5c; position: sticky; top: 70px; z-index: 10; overflow-x: auto; }
        .tab { color: #bdc3c7; font-weight: bold; padding: 5px 10px; cursor: pointer; font-size: 15px; position: relative; white-space: nowrap; }
        .tab.active { color: #f1c40f; }
        .tab.active::after { content: ''; position: absolute; bottom: -17px; left: 0; width: 100%; height: 3px; background-color: #f1c40f; }

        /* LISTE */
        .content-area { padding: 20px; padding-bottom: 80px; overflow-y: auto; flex-grow: 1; }
        .level-card { 
            background-color: #3e5c6a; border: 2px solid #d4a35a; border-radius: 12px; 
            display: flex; align-items: center; justify-content: space-between;
            padding: 20px; margin-bottom: 15px; cursor: pointer; transition: transform 0.1s;
        }
        .level-card:active { transform: scale(0.98); }
        .level-icon { font-size: 28px; margin-right: 15px; }
        .level-info { font-size: 18px; font-weight: bold; }
        .level-progress { color: #ecf0f1; font-size: 14px; opacity: 0.8; }

        /* FORM */
        .add-word-container { background-color: #3e5c6a; padding: 20px; border-radius: 15px; border: 2px solid #f1c40f; margin-bottom: 20px; }
        .form-group { margin-bottom: 15px; }
        .form-label { display: block; margin-bottom: 8px; font-size: 14px; color: #bdc3c7; font-weight: bold; }
        .form-input, .form-select, .form-textarea { width: 100%; padding: 12px; background-color: #2c3e50; border: 1px solid #546e7a; border-radius: 10px; color: white; font-size: 16px; box-sizing: border-box; }
        .form-input:focus, .form-select:focus { outline: none; border-color: #f1c40f; }
        .form-textarea { min-height: 120px; font-family: monospace; resize: vertical; }
        .save-btn { width: 100%; padding: 15px; background-color: #f1c40f; color: #1a1a1a; border: none; border-radius: 10px; font-size: 16px; font-weight: bold; cursor: pointer; margin-top: 10px; }
        .save-btn:active { transform: scale(0.98); }
        
        /* TEST & SONU√á EKRANLARI */
        #quiz-screen, #result-screen { display: none; flex-direction: column; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background-color: #1a1a1a; z-index: 20; }
        #quiz-screen { padding: 20px; }
        #result-screen { align-items: center; justify-content: center; background-color: rgba(26,26,26,0.95); z-index: 60; }
        
        .quiz-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; height: 50px; }
        .close-btn { font-size: 28px; cursor: pointer; color: #3498db; }
        .progress-container { display: flex; align-items: center; gap: 10px; margin-bottom: 40px; }
        .progress-track { flex-grow: 1; height: 6px; background-color: #333; border-radius: 3px; overflow: hidden; }
        #progress-fill { width: 0%; height: 100%; background-color: #3498db; transition: width 0.3s; }
        
        .quiz-content { flex-grow: 1; text-align: center; display: flex; flex-direction: column; align-items: center; }
        .word-to-solve { font-size: 36px; font-weight: 800; margin-bottom: 50px; color: #fff; }
        .options { width: 100%; display: flex; flex-direction: column; gap: 15px; }
        .option-btn { background-color: #262626; border: none; color: #bdc3c7; padding: 20px; border-radius: 30px; font-size: 16px; font-weight: 500; cursor: pointer; }
        .option-btn.correct { background-color: #a2c638; color: white; }
        .option-btn.wrong { background-color: #e74c3c; color: white; }
        
        #success-overlay { display: none; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 140px; height: 140px; background-color: #a2c638; border-radius: 50%; justify-content: center; align-items: center; z-index: 50; }
        .checkmark { width: 40px; height: 70px; border-bottom: 10px solid white; border-right: 10px solid white; transform: rotate(45deg); margin-top: -15px; }

        .result-card { background-color: #3e5c6a; width: 80%; padding: 30px; border-radius: 20px; text-align: center; border: 2px solid #d4a35a; }
        .score-circle { width: 100px; height: 100px; border-radius: 50%; background: conic-gradient(#f1c40f 0% 0%, #333 0% 100%); margin: 0 auto 20px auto; display: flex; align-items: center; justify-content: center; font-size: 24px; font-weight: bold; position: relative; }
        .score-circle::before { content: ""; position: absolute; width: 80px; height: 80px; background-color: #3e5c6a; border-radius: 50%; }
        .score-text { position: relative; z-index: 2; }
        .home-btn { background-color: #f1c40f; color: #1a1a1a; border: none; padding: 15px 40px; border-radius: 30px; font-size: 18px; font-weight: bold; cursor: pointer; margin-top: 20px; }
    </style>
</head>
<body>

<div class="app-container">
    <div id="home-screen">
        <header class="home-header">
            <div class="settings-icon">‚öôÔ∏è</div>
            <div class="app-title" id="app-header-title">C - Seviyesi</div>
            <div class="profile-pic">üë®üèª‚Äçüíº</div>
        </header>

        <div class="tabs">
            <div class="tab" onclick="switchTab('YDS', this)">YDS</div>
            <div class="tab" onclick="switchTab('H', this)">HABER</div>
            <div class="tab" onclick="switchTab('B2', this)">B2</div>
            <div class="tab" onclick="switchTab('B1', this)">B1</div>
            <div class="tab active" onclick="switchTab('C', this)">C</div>
            <div class="tab" onclick="switchTab('ADD', this)">‚ûï EKLE</div>
        </div>

        <div class="content-area" id="content-container"></div>
    </div>

    <div id="quiz-screen">
        <header class="quiz-header">
            <div class="close-btn" onclick="quitQuiz()">‚úï</div>
            <div style="font-weight:bold;">Test</div>
            <div style="width:24px;"></div>
        </header>
        <div class="progress-container">
            <div class="progress-track"><div id="progress-fill"></div></div>
            <div style="color:#3498db; font-weight:bold;" id="progress-text">1/20</div>
        </div>
        <div class="quiz-content">
            <div style="font-size:32px; color:#f1c40f; margin-bottom:20px;">üîä</div>
            <div class="word-to-solve" id="target-word">...</div>
            <div class="options" id="options-container"></div>
        </div>
        <div id="success-overlay"><div class="checkmark"></div></div>
    </div>

    <div id="result-screen">
        <div class="result-card">
            <div style="font-size:24px; font-weight:bold; margin-bottom:10px;">Bitti!</div>
            <div class="score-circle" id="score-circle"><span class="score-text" id="final-score">0</span></div>
            <button class="home-btn" onclick="closeResultScreen()">Devam Et</button>
        </div>
    </div>
</div>

<script>
    // --- SABƒ∞T KELƒ∞MELER (Sƒ∞Lƒ∞NMEZ) ---
    const fixedData = { "YDS": {}, "H": {}, "B2": {}, "B1": {}, "C": {} };
    
    // C Seviye 1-4 (Sabit)
    fixedData["C"][1] = [
        {en:"Abandon", tr:"Terk etmek"}, {en:"Abolish", tr:"Y√ºr√ºrl√ºkten kaldƒ±rmak"}, {en:"Accomplish", tr:"Ba≈üarmak"}, 
        {en:"Accumulate", tr:"Biriktirmek"}, {en:"Acquire", tr:"Edinmek"}, {en:"Adopt", tr:"Benimsemek"}, 
        {en:"Advocate", tr:"Savunmak"}, {en:"Alleviate", tr:"Hafifletmek"}, {en:"Alter", tr:"Deƒüi≈ütirmek"}, 
        {en:"Ambiguity", tr:"Belirsizlik"}, {en:"Assess", tr:"Deƒüerlendirmek"}, {en:"Benefit", tr:"Fayda"}, 
        {en:"Boost", tr:"Artƒ±rmak"}, {en:"Coincide", tr:"Rastlamak"}, {en:"Compensate", tr:"Telafi etmek"}, 
        {en:"Comprise", tr:"Olu≈ümak"}, {en:"Conceal", tr:"Gizlemek"}, {en:"Conduct", tr:"Y√ºr√ºtmek"}, 
        {en:"Confine", tr:"Sƒ±nƒ±rlandƒ±rmak"}, {en:"Cope with", tr:"Ba≈üa √ßƒ±kmak"}
    ];
    fixedData["C"][2] = [
        {en:"Debate", tr:"Tartƒ±≈ümak"}, {en:"Decade", tr:"On yƒ±l"}, {en:"Decay", tr:"√á√ºr√ºmek"}, {en:"Deceive", tr:"Aldatmak"}, 
        {en:"Declare", tr:"ƒ∞lan etmek"}, {en:"Decline", tr:"Reddetmek"}, {en:"Dedicate", tr:"Adamak"}, {en:"Deduce", tr:"Sonu√ß √ßƒ±karmak"},
        {en:"Defect", tr:"Kusur"}, {en:"Defend", tr:"Savunmak"}, {en:"Defer", tr:"Ertelemek"}, {en:"Deficiency", tr:"Eksiklik"},
        {en:"Deficit", tr:"A√ßƒ±k"}, {en:"Define", tr:"Tanƒ±mlamak"}, {en:"Definite", tr:"Kesin"}, {en:"Delay", tr:"Gecikmek"},
        {en:"Delicate", tr:"Hassas"}, {en:"Demonstrate", tr:"G√∂stermek"}, {en:"Denial", tr:"ƒ∞nkar"}, {en:"Denounce", tr:"Kƒ±namak"}
    ];
    // Seviye 3 ve 4 bo≈ü √∂rnek
    fixedData["C"][3] = [{en:"Derive", tr:"T√ºretmek"}, {en:"Detect", tr:"Tespit etmek"}]; 
    fixedData["C"][4] = [{en:"Enable", tr:"Olanak saƒülamak"}, {en:"Ensure", tr:"Saƒülamak"}];

    let vocabularyData = {};
    const DB_KEY = 'myVocabApp_AutoSave_v1';

    // 1. BA≈ûLATMA: Veriyi hafƒ±zadan √ßek, yoksa sabit veriyi kullan
    function initApp() {
        const stored = localStorage.getItem(DB_KEY);
        if(stored) {
            vocabularyData = JSON.parse(stored);
            // Sabit verileri her zaman garantiye al (silinmeye kar≈üƒ±)
            for(let cat in fixedData) {
                for(let lvl in fixedData[cat]) {
                    if(!vocabularyData[cat]) vocabularyData[cat] = {};
                    if(!vocabularyData[cat][lvl] || vocabularyData[cat][lvl].length === 0) {
                        vocabularyData[cat][lvl] = fixedData[cat][lvl];
                    }
                }
            }
        } else {
            vocabularyData = JSON.parse(JSON.stringify(fixedData));
            saveToMemory();
        }
    }

    // 2. OTOMATƒ∞K KAYIT (Arka Planda √áalƒ±≈üƒ±r)
    function saveToMemory() {
        localStorage.setItem(DB_KEY, JSON.stringify(vocabularyData));
    }

    // --- UYGULAMA AKI≈ûI ---
    let activeCategory = 'C';
    let currentQuestions = [];
    let currentStep = 0, correctCount = 0;

    window.onload = function() {
        initApp();
        switchTab('C', document.querySelector('.tabs .tab.active'));
    };

    function switchTab(cat, el) {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        if(el) el.classList.add('active');
        
        if(cat === 'ADD') {
            document.getElementById('app-header-title').innerText = "Kelime Ekle";
            renderAddScreen();
        } else {
            activeCategory = cat;
            document.getElementById('app-header-title').innerText = cat + " - Seviyesi";
            renderList(cat);
        }
    }

    // --- Lƒ∞STELEME EKRANI ---
    function renderList(cat) {
        const div = document.getElementById('content-container');
        div.innerHTML = "";
        const icons = ["üõ°Ô∏è","‚úçÔ∏è","üîç","üß†","üìö","üöÄ","üíé","üî•"];
        
        for(let i=1; i<=20; i++) {
            if(!vocabularyData[cat]) vocabularyData[cat] = {};
            if(!vocabularyData[cat][i]) vocabularyData[cat][i] = [];
            
            let count = vocabularyData[cat][i].length;
            let status = count > 0 ? `(${count} Kelime)` : "(Bo≈ü)";
            let style = count > 0 ? "" : "opacity:0.6;";
            
            div.innerHTML += `
                <div class="level-card" onclick="startQuiz(${i})" style="${style}">
                    <div><span class="level-icon">${icons[(i-1)%icons.length]}</span> <span class="level-info">${i}. Seviye</span></div>
                    <div class="level-progress">${status}</div>
                </div>
            `;
        }
    }

    // --- EKLEME EKRANI ---
    function renderAddScreen() {
        document.getElementById('content-container').innerHTML = `
            <div class="add-word-container">
                <div style="font-weight:bold; color:#f1c40f; margin-bottom:10px;">1. Hedef</div>
                <div style="display:flex; gap:10px; margin-bottom:15px;">
                    <select id="t-cat" class="form-select">
                        <option value="YDS">YDS</option><option value="H">HABER</option>
                        <option value="B2">B2</option><option value="B1">B1</option>
                        <option value="C" selected>C</option>
                    </select>
                    <select id="t-lvl" class="form-select">
                        ${Array.from({length:20}, (_,i)=>`<option value="${i+1}">${i+1}. Seviye</option>`).join('')}
                    </select>
                </div>

                <div style="font-weight:bold; color:#f1c40f; margin-bottom:10px;">2. Kelimeleri Yaz</div>
                <div style="font-size:12px; color:#bdc3c7; margin-bottom:5px;">√ñrnek:<br>Apple : Elma<br>Run : Ko≈ümak</div>
                <textarea id="bulk-txt" class="form-textarea" placeholder="Buraya yapƒ±≈ütƒ±r..."></textarea>
                
                <button class="save-btn" onclick="addWords()">‚úÖ Otomatik Kaydet</button>
            </div>
        `;
    }

    function addWords() {
        const txt = document.getElementById('bulk-txt').value.trim();
        const cat = document.getElementById('t-cat').value;
        const lvl = parseInt(document.getElementById('t-lvl').value);
        
        if(!txt) { alert("Bo≈ü veri girilemez."); return; }
        
        const lines = txt.split('\n');
        let added = 0;
        
        lines.forEach(line => {
            // Ayƒ±rƒ±cƒ±lar: iki nokta, e≈üittir veya tab
            let splitChar = line.includes(':') ? ':' : (line.includes('=') ? '=' : '\t');
            let parts = line.split(splitChar);
            if(parts.length >= 2) {
                let en = parts[0].trim();
                let tr = parts.slice(1).join(splitChar).trim();
                if(en && tr) {
                    if(!vocabularyData[cat][lvl]) vocabularyData[cat][lvl] = [];
                    vocabularyData[cat][lvl].push({en, tr});
                    added++;
                }
            }
        });

        if(added > 0) {
            saveToMemory(); // ARKA PLANDA KAYDET
            alert(`${added} kelime ba≈üarƒ±yla eklendi! (Otomatik kaydedildi)`);
            document.getElementById('bulk-txt').value = "";
        } else {
            alert("Format anla≈üƒ±lamadƒ±. 'Kelime : Anlam' ≈üeklinde yazmalƒ±sƒ±n.");
        }
    }

    // --- TEST Sƒ∞STEMƒ∞ ---
    function startQuiz(lvl) {
        if(activeCategory === 'ADD') return;
        let words = vocabularyData[activeCategory][lvl];
        if(!words || words.length === 0) { alert("Bu seviye bo≈ü."); return; }
        
        // Sorularƒ± Hazƒ±rla
        currentQuestions = words.map(w => {
            let others = ["Gitmek","Gelmek","Ko≈ümak","Bakmak","G√∂rmek","Duymak","Yazmak"]; // Yedek havuz
            // T√ºm havuzdan rastgele 3 yanlƒ±≈ü ≈üƒ±k bul
            let pool = [];
            // O kategorideki t√ºm kelimeleri havuza ekle
            for(let l=1; l<=20; l++) {
                 if(vocabularyData[activeCategory][l]) pool.push(...vocabularyData[activeCategory][l].map(x=>x.tr));
            }
            pool.push(...others);
            
            let opts = [w.tr];
            while(opts.length < 4) {
                let r = pool[Math.floor(Math.random()*pool.length)];
                if(!opts.includes(r)) opts.push(r);
            }
            return { en: w.en, correct: w.tr, options: opts.sort(()=>0.5-Math.random()) };
        });

        currentStep = 0; correctCount = 0;
        document.getElementById('home-screen').style.display = 'none';
        document.getElementById('quiz-screen').style.display = 'flex';
        renderQuestion();
    }

    function renderQuestion() {
        if(currentStep >= currentQuestions.length) { showResult(); return; }
        let q = currentQuestions[currentStep];
        document.getElementById('target-word').innerText = q.en;
        document.getElementById('progress-text').innerText = `${currentStep+1}/${currentQuestions.length}`;
        document.getElementById('progress-fill').style.width = `${((currentStep+1)/currentQuestions.length)*100}%`;
        
        let html = "";
        q.options.forEach(opt => {
            html += `<button class="option-btn" onclick="check(this, '${opt}', '${q.correct}')">${opt}</button>`;
        });
        document.getElementById('options-container').innerHTML = html;
    }

    function check(btn, sel, cor) {
        document.querySelectorAll('.option-btn').forEach(b=>b.disabled=true);
        if(sel === cor) {
            btn.classList.add('correct'); correctCount++;
            document.getElementById('success-overlay').style.display='flex';
            setTimeout(()=>{ document.getElementById('success-overlay').style.display='none'; next(); }, 800);
        } else {
            btn.classList.add('wrong');
            document.querySelectorAll('.option-btn').forEach(b=>{if(b.innerText===cor) b.classList.add('correct')});
            setTimeout(next, 1500);
        }
    }
    
    function next() { currentStep++; renderQuestion(); }
    
    function showResult() {
        document.getElementById('quiz-screen').style.display='none';
        document.getElementById('result-screen').style.display='flex';
        let total = currentQuestions.length;
        document.getElementById('final-score').innerText = `${correctCount}/${total}`;
        let p = (correctCount/total)*100;
        let c = p>=50 ? '#a2c638' : '#e74c3c';
        document.getElementById('score-circle').style.background = `conic-gradient(${c} 0% ${p}%, #333 ${p}% 100%)`;
    }

    function closeResultScreen() {
        document.getElementById('result-screen').style.display='none';
        document.getElementById('home-screen').style.display='flex';
        renderList(activeCategory);
    }
    function quitQuiz() { if(confirm("√áƒ±kƒ±≈ü?")) closeResultScreen(); }
</script>
</body>
</html>
